<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Helmet Detection | Kirtan Kanani</title> <meta name="author" content="Kirtan Kanani"> <meta name="description" content="Object detection from videos using yolo model"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?19f3075a2d19613090fe9e16b564e1fe" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://kirtan517.github.io/projects/1_project/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?e74e74bf055e5729d44a7d031a5ca6a5" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?6185d15ea1982787ad7f435576553d64"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Kirtan </span>Kanani</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">projects<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Helmet Detection</h1> <p class="post-description">Object detection from videos using yolo model</p> </header> <article> <h2 id="yolo-v5-model">YOLO v5 Model</h2> <p>In this approach, all the images and labels were trained on the yolov5m model.</p> <p><br></p> <p align="center"> <figure> <picture> <source class="responsive-img-srcset" srcset=" /assets/img/projects/HelmetDetection/Images/confusion_matrix-480.webp 480w, /assets/img/projects/HelmetDetection/Images/confusion_matrix-800.webp 800w, /assets/img/projects/HelmetDetection/Images/confusion_matrix-1400.webp 1400w, " sizes="95vw" type="image/webp"></source> <img src="/assets/img/projects/HelmetDetection/Images/confusion_matrix.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Confusion Matrix" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </p> <p>As it can be seen from the correlation matrix that the model was unable to predict the P1Helmet correctly at all of the predictions for that class were wrong and same goes for P2Helmet and P2NoHelmet as well.</p> <p align="center"> <figure> <picture> <source class="responsive-img-srcset" srcset=" /assets/img/projects/HelmetDetection/Images/labels-480.webp 480w, /assets/img/projects/HelmetDetection/Images/labels-800.webp 800w, /assets/img/projects/HelmetDetection/Images/labels-1400.webp 1400w, " sizes="95vw" type="image/webp"></source> <img src="/assets/img/projects/HelmetDetection/Images/labels.jpg" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="labels" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </p> <p>As it can be seen from the above figure the there is high class mismatch as there are small number of bounding box which are being identified as the P1Helmet , P2Helmet and P2NoHelmet this might be causing the model to perform poorly on the P1Helmet classification.</p> <p align="center"> <figure> <picture> <source class="responsive-img-srcset" srcset=" /assets/img/projects/HelmetDetection/Images/F1_curve-480.webp 480w, /assets/img/projects/HelmetDetection/Images/F1_curve-800.webp 800w, /assets/img/projects/HelmetDetection/Images/F1_curve-1400.webp 1400w, " sizes="95vw" type="image/webp"></source> <img src="/assets/img/projects/HelmetDetection/Images/F1_curve.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="F1 curve" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <figure> <picture> <source class="responsive-img-srcset" srcset=" /assets/img/projects/HelmetDetection/Images/PR_curve-480.webp 480w, /assets/img/projects/HelmetDetection/Images/PR_curve-800.webp 800w, /assets/img/projects/HelmetDetection/Images/PR_curve-1400.webp 1400w, " sizes="95vw" type="image/webp"></source> <img src="/assets/img/projects/HelmetDetection/Images/PR_curve.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="PR curve" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </p> <p>The major for such a low prediction for P2 might be that having 3 people on the motorbike is a rare event and further to classify that it’s the p2 model need to first identify that there is p1 present in the motorbike so such sort of sequential learning might be causing the model to predict poorly on this particular class.</p> <p align="center"> <figure> <picture> <source class="responsive-img-srcset" srcset=" /assets/img/projects/HelmetDetection/Images/Train_test_yolov5-480.webp 480w, /assets/img/projects/HelmetDetection/Images/Train_test_yolov5-800.webp 800w, /assets/img/projects/HelmetDetection/Images/Train_test_yolov5-1400.webp 1400w, " sizes="95vw" type="image/webp"></source> <img src="/assets/img/projects/HelmetDetection/Images/Train_test_yolov5.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="train test result" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </p> <p align="center"> <figure> <picture> <source class="responsive-img-srcset" srcset=" /assets/img/projects/HelmetDetection/Images/P_curve-480.webp 480w, /assets/img/projects/HelmetDetection/Images/P_curve-800.webp 800w, /assets/img/projects/HelmetDetection/Images/P_curve-1400.webp 1400w, " sizes="95vw" type="image/webp"></source> <img src="/assets/img/projects/HelmetDetection/Images/P_curve.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="P Curve" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> <figure> <picture> <source class="responsive-img-srcset" srcset=" /assets/img/projects/HelmetDetection/Images/R_curve-480.webp 480w, /assets/img/projects/HelmetDetection/Images/R_curve-800.webp 800w, /assets/img/projects/HelmetDetection/Images/R_curve-1400.webp 1400w, " sizes="95vw" type="image/webp"></source> <img src="/assets/img/projects/HelmetDetection/Images/R_curve.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="R Curve" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </p> <h3 id="results-on-test-dataset">Results on Test Dataset</h3> <p align="center"> <figure> <picture> <source class="responsive-img-srcset" srcset=" /assets/img/projects/HelmetDetection/Images/yolov5Prediction-480.webp 480w, /assets/img/projects/HelmetDetection/Images/yolov5Prediction-800.webp 800w, /assets/img/projects/HelmetDetection/Images/yolov5Prediction-1400.webp 1400w, " sizes="95vw" type="image/webp"></source> <img src="/assets/img/projects/HelmetDetection/Images/yolov5Prediction.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="yolov5 Predictions" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </p> <h3 id="exploratory-data-analysis-and-preprocessing">Exploratory Data Analysis And Preprocessing</h3> <p align="center"> <figure> <picture> <source class="responsive-img-srcset" srcset=" /assets/img/projects/HelmetDetection/Images/EDA-480.webp 480w, /assets/img/projects/HelmetDetection/Images/EDA-800.webp 800w, /assets/img/projects/HelmetDetection/Images/EDA-1400.webp 1400w, " sizes="95vw" type="image/webp"></source> <img src="/assets/img/projects/HelmetDetection/Images/EDA.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="EDA" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </p> <p>As can be seen from the above curves the best height and width to be selected for resizing the image would be around 100. And as can be seen on average most of the images have 2-4 objects.</p> <p><br></p> <h2 id="using-neural-network-as-a-classifier">Using Neural Network as a Classifier</h2> <p>In this approach firstly a yolo network was used to identify the different object present in the image which is motorbike and person. Then the results of the model which are the cropped images of the bounding boxes detected for these object is passed to an efficient net architecture to classify if that cropped image is one of the seven class described in the competition. One extra class was added so as to make the model classify the cropped image as other if none of those seven classes meet. <br> But during the training this efficient net architecture was trained with the cropped images obtained from the ground truth.</p> <p align="center"> <figure> <picture> <source class="responsive-img-srcset" srcset=" /assets/img/projects/HelmetDetection/Images/TrainingNeuralNet-480.webp 480w, /assets/img/projects/HelmetDetection/Images/TrainingNeuralNet-800.webp 800w, /assets/img/projects/HelmetDetection/Images/TrainingNeuralNet-1400.webp 1400w, " sizes="95vw" type="image/webp"></source> <img src="/assets/img/projects/HelmetDetection/Images/TrainingNeuralNet.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Training Neural Net" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </p> <p>As the model uses pretrained weights but the parameters are not frozen during training thus it requires few epochs to get used to the new dataset.</p> <p align="center"> <figure> <picture> <source class="responsive-img-srcset" srcset=" /assets/img/projects/HelmetDetection/Images/Confusion_matrix_neuralNet-480.webp 480w, /assets/img/projects/HelmetDetection/Images/Confusion_matrix_neuralNet-800.webp 800w, /assets/img/projects/HelmetDetection/Images/Confusion_matrix_neuralNet-1400.webp 1400w, " sizes="95vw" type="image/webp"></source> <img src="/assets/img/projects/HelmetDetection/Images/Confusion_matrix_neuralNet.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Confusion Matrix of Neural Net" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </p> <p>As it can be seen from this confusion matrix that although the model is performing really well still as there is not dataset for other category it will be difficult for the model to classify the cropped image into this one</p> <p align="center"> <figure> <picture> <source class="responsive-img-srcset" srcset=" /assets/img/projects/HelmetDetection/Images/NeuralNetRCurve-480.webp 480w, /assets/img/projects/HelmetDetection/Images/NeuralNetRCurve-800.webp 800w, /assets/img/projects/HelmetDetection/Images/NeuralNetRCurve-1400.webp 1400w, " sizes="95vw" type="image/webp"></source> <img src="/assets/img/projects/HelmetDetection/Images/NeuralNetRCurve.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Neural Net PR curve" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </p> <h3 id="results-on-test-dataset-1">Results on Test Dataset</h3> <p align="center"> <figure> <picture> <source class="responsive-img-srcset" srcset=" /assets/img/projects/HelmetDetection/Images/NeuralNetPrediction-480.webp 480w, /assets/img/projects/HelmetDetection/Images/NeuralNetPrediction-800.webp 800w, /assets/img/projects/HelmetDetection/Images/NeuralNetPrediction-1400.webp 1400w, " sizes="95vw" type="image/webp"></source> <img src="/assets/img/projects/HelmetDetection/Images/NeuralNetPrediction.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Neural Net Predictions" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </p> <p>Note – in this approach yolo model was not trained at all and as yolo model was not trained at all and the classifier does not have any of the cropped images for the other category it classifying each and every person bounding box predicted by the yolo model as either of those 7 classes Now the above issue could have been solved by generating the custom dataset by passing it thorough yolo and checking IoU with the ground truth values and if the IoU is equal to 0 then that cropped image should have been marked as other and then the model should have been trained on this dataset. But because of the time constrain I was not able to do that.</p> <h2 id="conclusion">Conclusion</h2> <p>The results can be improved by using different data augmentation techniques and creating custom dataset as mentioned above with few modification. Also different model can be tried with to check which model best results in better accuracy <br> Overall It seems that with just the yolo model the model is not able to detect all the object present in the image whereas with the second approach of using yolo and other classifier it seems as it’s detecting too much so may be some ensemble method might also help improve the accuracy.</p> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2024 Kirtan Kanani. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?7b30caa5023af4af8408a472dc4e1ebb"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?9b43d6e67ddc7c0855b1478ee4c48c2d" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-5Q0VP07CHQ"></script> <script>function gtag(){window.dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-5Q0VP07CHQ");</script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>